<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Process risk log</title>
    <link rel="stylesheet" href="/assets/libs/layui/css/layui.css"/>
    <link rel="stylesheet" href="/assets/module/admin.css">
    <link rel="stylesheet" href="/assets/admin.css">
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <style>
        .console-link-block {
            font-size: 16px;
            padding: 20px 20px;
            border-radius: 4px;
            background-color: #FEAA4F;
            color: #FFFFFF !important;
            box-shadow: 0 2px 3px rgba(0, 0, 0, .05);
            position: relative;
            overflow: hidden;
            display: block;
        }

        .console-link-block .console-link-block-num {
            font-size: 40px;
            margin-bottom: 5px;
            opacity: .9;
        }

        .console-link-block .console-link-block-text {
            opacity: .8;
        }

        .console-link-block .console-link-block-icon {
            position: absolute;
            top: 50%;
            right: 20px;
            width: 50px;
            height: 50px;
            font-size: 50px;
            line-height: 50px;
            margin-top: -25px;
            color: #FFFFFF;
            opacity: .8;
        }

        .console-link-block .console-link-block-band {
            color: #fff;
            width: 100px;
            font-size: 12px;
            padding: 2px 0 3px 0;
            background-color: #E32A16;
            line-height: inherit;
            text-align: center;
            position: absolute;
            top: 8px;
            right: -30px;
            transform-origin: center;
            transform: rotate(45deg) scale(.8);
            opacity: .95;
            z-index: 2;
        }


        
        .layui-row > div:nth-child(1) .console-link-block {
            background-color: #FF6600;
        }
    
        .layui-row > div:nth-child(2) .console-link-block {
            background-color: #10B4E8;
        }

        .layui-row > div:nth-child(3) .console-link-block {
        	  //background-color: #FF0000;
            background-color: #3399ff;
        }

        .layui-row > div:nth-child(4) .console-link-block {
            background-color: #F591A2;
        }

        .layui-row > div:nth-child(5) .console-link-block {
            background-color: #9BC539;
        }
        .layui-row > div:nth-child(6) .console-link-block {
            background-color: #009688;
        }
        .layui-row > div:nth-child(7) .console-link-block {
            background-color: #009688;
        }

        .layui-row > div:last-child .console-link-block {
            background-color: #009688;
        }
    </style>
</head>
<body>

<div class="layui-fluid ew-console-wrapper">

  <div class="layui-row layui-col-space15">
     
       <div class="layui-col-md4 layui-col-sm6">
            <div class="layui-card" >
                <div class="layui-card-header" id="weekflow">Middle risk</div>
                <div class="layui-card-body">
                    <div id="consoleChartsAtk" style="height: 300px;"></div>
                </div>
            </div>
        </div>
        <div class="layui-col-md4 layui-col-sm6">
            <div class="layui-card" style="overflow: hidden;">
                <div class="layui-card-header" id="weekip">High risk</div>
                <div class="layui-card-body">
                    <div id="consoleChartsIP" style="height: 300px;"></div>
                </div>
            </div>
        </div>
        
         <div class="layui-col-md4 layui-col-sm6">
            <div class="layui-card" style="overflow: hidden;">
                <div class="layui-card-header" id="dayflow">Risk analysis</div>
                <div class="layui-card-body">
                    <div id="consoleChartsFlowWeek" style="height: 300px;"></div>
                </div>
            </div>
        </div>         
 
    <div class="layui-col-md8  layui-col-sm6">
         <div class="layui-card">
          	<div class="layui-card-header" id="procdata">AI risk analysisï¼ˆsystem has been running for at least 7 days)</div>
            <div class="layui-tab layui-tab-brief "  lay-filter="tab-title">          
              <div class="layui-tab-content" >
                <div class="layui-tab-item layui-show" id="tab-item0">
                  <table id="table0" lay-filter="table0"></table>
                </div>
                
                <div class="layui-tab-item"  id="tab-item1">
                  <table id="table1" lay-filter="table1"></table>
                </div>
                
                 <div class="layui-tab-item"  id="tab-item2">
                  <table id="table2" lay-filter="table2"></table>
                </div>
                
                <div class="layui-tab-item"  id="tab-item3">
                  <table id="table3"></table>
                </div>
                
                <div class="layui-tab-item" id="tab-item4">
                  <table id="table4"></table>
                </div>
                
                <div class="layui-tab-item"  id="tab-item5">
                  <table id="table5"></table>
                </div>
                
                 <div class="layui-tab-item"  id="tab-item6">
                  <table id="table6"></table>
                </div>
                
                <div class="layui-tab-item"  id="tab-item7">
                  <table id="table7"></table>
                </div>
                
               
              </div>
            </div>
          </div>
    </div>  
    
        
    <div class="layui-col-md4"> 
    	  
    	<div class="layui-card">
    		 <div style="margin-left:-50px;margin-right:0px">
       
            <form class="layui-form toolbar">
            	  <input name="pageNum"  value="1" type="hidden"/>
            	  <input name="pageSize" value="10" type="hidden"/>
            	  
                <div class="layui-form-item">
                	  <div class="layui-inline">
                        <label class="layui-form-label">Date</label>
                        <div class="layui-input-inline">
                            <input id="startEndTime" class="layui-input icon-date" placeholder="Default to today" autocomplete="off"/>
                        </div>
                    </div>                    
                 
                    <div class="layui-inline">&emsp;
                        <button class="layui-btn icon-btn" lay-filter="tableSearch" lay-submit>
                            <i class="layui-icon">&#xe615;</i>Search
                        </button>
                    </div>
                    
                    <div class="layui-inline" id="proc_name"></div> 
                        
                 </div>
            </form>
         </div>
         
        
            
        <div class="layui-card-body" style="padding: 10px 10px;height: 435px">
          <table id="LAY-home-homepage-admin"></table>
        </div>
      </div>      
    </div>
    
   
    

  </div>
</div>

<script src="/assets/libs/layui/layui.js"></script>
<script src="/assets/js/common.js"></script>
<script src="/assets/libs/echarts/echarts.min.js"></script>
<!--
<script src="/assets/libs/echarts/china.js"></script>
<script src="/assets/libs/echarts/echarts-wordcloud.min.js"></script> -->
<script src="/assets/libs/echarts/echartsTheme.js"></script>
<script src="/assets/js/jquery-3.2.1.min.js" ></script>
<script src="/assets/js/util.js"></script>


<script type="text/html" id="flowTpl">	
    <div> 
        {{# if (parseInt(d.rx_bytes) > 1024*1024*1024) { }}
           <span class="layui-badge layui-bg-orange">{{parseFloat(parseInt(d.rx_bytes)/1073741824).toFixed(3)}} GB</span>
        {{# } else if (parseInt(d.rx_bytes) > 1024*1024) { }}  
         	 <span>{{parseFloat(parseInt(d.rx_bytes)/1048576).toFixed(0)}} MB</span>
        {{# } else if (parseInt(d.rx_bytes) > 1024) { }}  
         	 <span>{{parseFloat(parseInt(d.rx_bytes)/1024).toFixed(0)}} KB</span> 	 
        {{# } else { }}
        	<span>{{parseFloat(parseInt(d.rx_bytes)/1).toFixed(0)}} B</span>
        {{# } }}		
    </div>
</script>


<script type="text/html" id="flowSend">	
    <div> 
        {{# if (parseInt(d.tx_bytes) > 1024*1024*1024) { }}
           <span class="layui-badge layui-bg-orange">{{parseFloat(parseInt(d.tx_bytes)/1073741824).toFixed(3)}} GB</span>
        {{# } else if (parseInt(d.tx_bytes) > 1024*1024) { }}  
         	 <span>{{parseFloat(parseInt(d.tx_bytes)/1048576).toFixed(0)}} MB</span>
        {{# } else if (parseInt(d.tx_bytes) > 1024) { }}  
         	 <span>{{parseFloat(parseInt(d.tx_bytes)/1024).toFixed(0)}} KB</span> 	 
        {{# } else { }}
        	 <span>{{parseFloat(parseInt(d.tx_bytes)/1).toFixed(0)}} B</span>
        {{# } }}		
    </div>
</script>

<script>

		//$(".layui-badge").html("8");

		var token = CoreUtil.getStok("token");
		if (token == undefined || token == null || token.length < 32 )
		    token = "12345678123456781234567812345678";	
	
    layui.use(['element','layer','table', 'tableX', 'notice', 'upload','xnUtil','laydate'], function () {
        var $ = layui.jquery;
        var layer = layui.layer;
        var  element = layui.element;
        var  table = layui.table;
        		        
		    var tableX = layui.tableX;
		    var admin = layui.admin;
		    var form = layui.form;
		    var notice = layui.notice;
		    var xnUtil = layui.xnUtil;
		    var rowindex =  0;
		    var upload = layui.upload;
		    var laydate = layui.laydate;
			       
        
        var URL_LIST = "/admin/proc_risk_week?token=" + CoreUtil.getStok("token") + 	'&time=' + Date.parse(new Date()) / 1000;
        var URL_FILTER = "/admin/filter_atklog?token=" + CoreUtil.getStok("token") + 	'&time=' + Date.parse(new Date()) / 1000; 
        var xdata1 = [];
        var xdata2 = []; 
        var ydata1 = [];
        var ydata2 = [];
        var ydata3 = [];
        var ydata4 = [];
        var ydata5 = [];  
        var run    = 0;
        var yname  = '(M)';
        var filter_name = '';
        
      
        laydate.render({
            elem: '#startEndTime',
            type: 'date', 
            lang: 'en',              
            trigger: 'click' 
            //value: getRecentDay(0)           
        });
        

			  element.on('tab(tab-title)', function(data){	
							load_process(data.index);
			  });
			  
   
        table.on('row(table0)', function (obj) { 
        	  filter_name = "admin/proc-change-file?token=" + token + "&date=" + obj.data.time + "&uri=" + obj.data.filename + "_" + obj.data.hash  + "_" + obj.data.proto +  "_"  + obj.data.listen;
        	  if ((obj.data.hash.length) > 5) { 
		        	  $.ajax({
			             type: "GET",
			             url:  getProjectUrl() + filter_name + '&time=' + Date.parse(new Date()) / 1000,
			             data: "{}",
			             async: false,
			             dataType: "text",
			             success: function( data ) {
			                 $('#contentBox').text(data);
			            }
		            });  
		             
		       	    $("#proc_name").html(obj.data.procname + " details");	
		            load_ip('tcp');
		            load_echarts('tcp');
           }
        });
        table.on('row(table1)', function (obj) { 
        	  filter_name = "admin/proc-change-file?token=" + token + "&uri=" + obj.data.filename + "_" + obj.data.hash  + "_" + obj.data.proto +  "_"  + obj.data.listen;
        	  if ((obj.data.hash.length) > 5) {
	        	   $.ajax({
		             type: "GET",
		             url:  getProjectUrl() + filter_name + '&time=' + Date.parse(new Date()) / 1000,
		             data: "{}",
		             async: false,
		             dataType: "text",
		             success: function( data ) {
		                 $('#contentBox').text(data);
		            }
              });  
	       	    $("#proc_name").html(obj.data.procname + " details");	
	            load_ip('udp');
	            load_echarts('tcp');
          }
        });
        table.on('row(table2)', function (obj) { 
        	  filter_name = "admin/proc-change-file?token=" + token + "&uri=" + obj.data.filename + "_" + obj.data.hash  + "_" + obj.data.proto +  "_"  + obj.data.listen;
        	  if ((obj.data.hash.length) > 5) {
	        	   $.ajax({
		             type: "GET",
		             url:  getProjectUrl() + filter_name + '&time=' + Date.parse(new Date()) / 1000,
		             data: "{}",
		             async: false,
		             dataType: "text",
		             success: function( data ) {
		                 $('#contentBox').text(data);
		            }
              });  
	       	    $("#proc_name").html(obj.data.procname + " details");	
	            load_ip('icmp');
	            load_echarts('icmp');
           }
        });
        
     
        form.on('submit(tableSearch)', function (data) {        	
        	  var tempStartTime = $('#startEndTime').val();
        	  
        	  if(tempStartTime === ''){ 
        	  	  data.field['searchBeginTime'] = "";
                data.field['searchEndTime'] = "";
        	  }else {	       	          	
                data.field['searchBeginTime'] = tempStartTime + " 00:00:00";
                data.field['searchEndTime'] = tempStartTime   +  " 23:59:59";
            }
            
            CoreUtil.sendAjax(URL_FILTER, CoreUtil.encode_str("page",JSON.stringify(data.field),0), function (res) {  
                                
            }, "POST", false, function (res) {            	
                    layer.msg("Login failed");
            });
             
            insTb.reload({where: data.field, page: false});
                   	
            return false;
        }); 
        
       function calc_time(v){
	    	  var  sec = parseInt(v) % 60;
	    	   
	         if(parseInt(v) > 60*60){
	        	 sec = (parseInt(v) % 3600) / 60; 
	            v = v * 1.0 / (60*60) - 0.5;                     
	            return v.toFixed(0) + " hour " + sec.toFixed(0)+ " min ";
	        }
	        if(parseInt(v) > 60){
	            v = v * 1.0 / (60);
	            return v.toFixed(0) + " min " + sec + " sec";
	        }
	        
	        return v + " sec";
       };   
       
       function getRecentDay(day) {
            var today = new Date();
            var targetday_milliseconds = today.getTime() + 1000 * 60 * 60 * 24 * day;
            today.setTime(targetday_milliseconds);
            var tYear = today.getFullYear();
            var tMonth = today.getMonth();
            var tDate = today.getDate();
            var tHours = today.getHours();
            var tMinutes = today.getMinutes();
            var tSeconds = today.getSeconds();
            tMonth = doHandleMonth(tMonth + 1);
            tDate = doHandleMonth(tDate);
            tHours = doHandleMonth(tHours);
            tMinutes = doHandleMonth(tMinutes);
            tSeconds = doHandleMonth(tSeconds);

            return tYear + "-" + tMonth + "-" + tDate ;//+ ' ' + tHours + ':' + tMinutes + ':' + tSeconds;
        };
        
       function doHandleMonth(month) {
            var m = month;
            if (month.toString().length == 1) {
                m = "0" + month;
            }
            return m;
        };    

			 function load_ip(proto) {   
				
				table.render({
					elem: "#LAY-home-homepage-admin",
					height: '455',
					cellMinWidth: 105,
					parseData: function(res){ 
					    return {
					      "code": res.error_code, 
					      "msg": "success", 
					      "count": 0, 
					      "data": res.result 
					    };
					}, 
					page: false,
					url: "/admin/proc_ip?" + proto + 'token=' + CoreUtil.getStok("token") + 	'&time=' + Date.parse(new Date()) / 1000,
					cols: [[
					{
						type: "numbers",
						fixed: "left",
						title: "ID",
						width: 50
					},
					{
						field: "procname",
						title: "IP",
						width: 150
					},
					{
						field: "geoip",
						title: "Location",			
					},  {
						field: "tx_bytes",
						title: "tx",
						sort:  true,
						templet:'#flowSend'
          },
					{
						field: "rx_bytes",
						title: "rx",
						sort:  true,
						templet:'#flowTpl'
          },		
        	
					{
						field: "risk",
						title: "risk",
						width: 100,
						templet: function(e) {
							return "Middle" == e.risk ? '<del style="color: #5FB878;">' + e.risk + "</del>": "high" == e.risk ? '<span style="color: #FFB800;">' + 
							       e.risk + "</span>": '<span style="color: #FF5722;">' + e.risk + "</span>"
						}
					}/*,
					{
						field: "stime",
						title: "start time",
						sort: true
					},  
          {
          	field: "etime",
          	title: "end time",
          	sort: true
          },
          {
          	field: "time",
          	title: "total time",
          	sort: true, 
          	templet: function (item) {
                            return calc_time(item.time);
                        }
          }*/]],
					skin: "line"
				});
					
			 }   
			
			
			 function load_process(myelem) {     
			  var URL_TAB = "/admin/proc_risklog"  + 	"?token=" + CoreUtil.getStok("token") + '&time=' + Date.parse(new Date());     

			          
        var insTb = tableX.render({
            elem: '#table' + myelem,
            url:  URL_TAB,
            page: true,  
            limit: 10,
            height: '450',
            parseData: function(res){ 
					    return {
					      "code": res.error_code,
					      "msg": "success", 
					      "count": res.count, 
					      "data": res.result
					    };
					  },          
            cellMinWidth: 100,
            cols: [
                [
                
                    {type: "numbers", title: 'ID'},
                    {field: "time",title: "Date",align:"center"},
                    {field: "procname",title: "Process name/CMD",width: 300,	sort: true,templet: function (d) {
                        return '<a style="color:dodgerblue;cursor: pointer" perm-show="flowableInstanceTask:page" lay-event="atk-log">' + d.procname +'</a>';
                    }},
                    {field: "msg",title: "Event",width: 400},                 
                    {field: "risk",title: "Risk"}
      	            /*
                    {field: "note",title: "Remarks",
                    	 templet: '<div><a href="/webpages/index.html?trace-log&sip={{ d.addr }}" target="_blank" class="layui-table-link">{{ d.note }}</div>'    	 
      	            }*/
                ]
            ],
            done: function(res, curr, count) {
                xnUtil.tableDone(insTb, res, curr, count);
                
                /*if (table.cache["dataTable"].length >= 1000) {
            	  	     layer.msg('Tip: Only display the top 1000 IP.', {icon: 6, time: 2000}, function () {
                   });                       	    
            	  }*/
            }
        });
        
			 }			 
			 
			 load_process(0);	
			 load_echarts('tcp');
			         
      function load_echarts(proto) {    
     
        CoreUtil.sendAjax(URL_LIST, CoreUtil.encode_str("get",JSON.stringify(""),0), function (res) {
         	  if (res.xdata2 != null && res.ydata1 != null && res.ydata2 != null && res.ydata5 != null) {
         	      xdata1 =  res.xdata1;
         	      xdata2 =  res.xdata2;
         	      ydata1 =  res.ydata1;
         	      ydata2 =  res.ydata2;
         	      ydata3 =  res.ydata3;
         	      ydata4 =  res.ydata4;
         	      ydata5 =  res.ydata5;         	 
         	  }
         	          	  
        	  
         	  
         	  if (res.risk != null) {
         	  	  run = res.risk;         	
         	  }
         	  
        }, "POST", false,null,null,false, function (res) {            	
                 layer.msg("Login failed");
        });
        
        if (xdata2.length == 0 || xdata1.length == 0) 
            return;
          
  

      
        var myCharts3 = echarts.init(document.getElementById('consoleChartsAtk'),myEchartsTheme);
        var options3 = {
            tooltip: {trigger: 'axis', axisPointer: {lineStyle: {color: '#E0E0E0'}}},
            color: ['#FFA800','#10B4E8'],          
            grid: {top: '15px', left: '35px', right: '55px', bottom: '40px'},
            xAxis: {
                name: 'Date',
                nameTextStyle: {color: '#595959'},
                type: 'category',
                data: xdata2,
                axisLine: {lineStyle: {color: '#E0E0E0'}, symbol: ['none', 'arrow'], symbolOffset: [0, 10]},
                axisLabel: {color: '#8c8c8c'},
                axisTick: {alignWithLabel: true}
            },
            yAxis: {
                name: 'Flow',
                nameTextStyle: {color: '#595959'},
                type: 'value',
                boundaryGap: ['0', '20%'],
                axisTick: {show: false},
                axisLine: {lineStyle: {color: '#E0E0E0'}, symbol: ['none', 'arrow'], symbolOffset: [0, 10]},
                axisLabel: {color: '#8c8c8c'},
                splitLine: {show: false},
                splitArea: {show: false},
                minInterval: 1
            },
            grid:{
            	  x:50,
            	  y:10
            },
            series: [{
                name: 'count', type: 'bar', stack: 'one', barMaxWidth: '30px',
                label: {normal: {show: true, position: 'top'}}
            }]
        };
        myCharts3.setOption(options3);
 
        myCharts3.setOption({
        	    series: [
        	        {data: ydata3}
        	]});

        myCharts3.on('click', function (params) {	
        	  var year = new Date();
				    var str  = year.getFullYear() + '-' + params.name;
				    
				   $.ajax({
			             type: "GET",
			             url:  getProjectUrl() + 'admin/proc-change-time?date=' + str +'&token=' + token +'&time=' + Date.parse(new Date()) / 1000,
			             data: "{}",
			             async: false,
			             dataType: "text",
			             success: function( data ) {
			                 //$('#contentBox').text(data);
			                  window.location.reload(); 
			                 
			            }
		       });  
		
        
			 });
			 



      
        var myCharts4 = echarts.init(document.getElementById('consoleChartsIP'));
        var options4 = {
            tooltip: {
                trigger: 'axis',
                axisPointer: {lineStyle: {color: '#E0E0E0'}},
                formatter: ''
            },
            color: ['#FF3300','#FFA800','#10B4E8'],
       
            grid: {top: '15px', left: '35px', right: '55px', bottom: '40px'},
            xAxis: {
                name: 'Date',
                nameTextStyle: {color: '#595959'},
                type: 'category',
                data: xdata2,
                axisLine: {lineStyle: {color: '#E0E0E0'}, symbol: ['none', 'arrow'], symbolOffset: [0, 10]},
                axisLabel: {
                    color: '#8c8c8c', interval: function (index, value) {
                        return index === 0 || ((index + 1) % 1 === 0);
                    }
                },
                axisTick: {alignWithLabel: true}
            },
            yAxis: {
                name: 'count',
                nameTextStyle: {color: '#595959'},
                type: 'value',
                boundaryGap: ['0', '20%'],
                axisTick: {show: false},
                axisLine: {lineStyle: {color: '#E0E0E0'}, symbol: ['none', 'arrow'], symbolOffset: [0, 10]},
                axisLabel: {color: '#8c8c8c'},
                splitLine: {show: false},
                splitArea: {show: false},
                minInterval: 1
            },
            grid:{
            	  x:50,
            	  y:10
            },
            series: [
            {
                name: 'count', type: 'bar', stack: 'one', barMaxWidth: '30px',
                label: {normal: {show: true, position: 'top'}}
            }
                //{name: 'count', type: 'line', false: true,itemStyle : { normal: {label : {show: true}}}}
            ]
        };
        myCharts4.setOption(options4);
    
        myCharts4.setOption({
            series: [
                {data: ydata4}
            ]
        });
        
        
             
   
        var myCharts1 = echarts.init(document.getElementById('consoleChartsFlowWeek'));
        var options1 = {
            title: {
                text: 'Risk level', x: 'center', y: '32%',
                textStyle: {fontSize: 18, color: '#262626', fontWeight: 'normal'},
                subtextStyle: {fontSize: 56, color: '#10B4E8'}, itemGap: 20
            },
            color: ['#10B4E8','#FFA800', '#FF3300'],
            tooltip: {trigger: 'item'},          
            series: [{name: '', type: 'pie', radius: ['75%', '80%'], label: {normal: {show: false}}}]
        };        
     
       myCharts1.setOption(options1); 
       if (run == "0") {
       	   myCharts1.setOption({
              title: {subtext: 'Low'}, 
              series: [{data: [{name: 'running', value: 1}, {name: 'Low', value: 0}]}]           
           });
       }    
       else if (run == "1") {   
       	
           myCharts1.setOption({               
               title: {subtext: 'Middle',subtextStyle: {fontSize: 56, color: '#FFA800'}, itemGap: 20}, 
               series: [{data: [{name: 'running', value: 0}, {name: 'Middle', value: 1}]}]
           });        
       } else {
        
           myCharts1.setOption({     
           	   color: ['#10B4E8','#FF3300'],         
               title: {subtext: 'High',subtextStyle: {fontSize: 56, color: '#FF3300'}, itemGap: 20}, 
               series: [{data: [{name: 'running', value: 0}, {name: 'High', value: 2}]}]
           });
        }            
    
       
       
     
        window.onresize = function () {
            myCharts1.resize();
            //myCharts2.resize();
            myCharts3.resize();
            myCharts4.resize();
            //myCharts5.resize();
          
        };
				
	   }

        
        
        
      table.render({
					elem: "#LAY-home-homepage-admin",
					height: '455',
					cellMinWidth: 105,
					parseData: function(res){ 
					    return {
					      "code": res.error_code, 
					      "msg": "success", 
					      "count": 0, 
					      "data": res.result 
					    };
					}, 
					url: "/admin/proc_ip?token="  + token + 	"&time=" + Date.parse(new Date()) / 1000 ,
					cols: [[
					{
						type: "numbers",
						fixed: "left",
						title: "ID",
						width: 30
					},
					{
						field: "procname",
						title: "IP",
						width: 150
					},
					{
						field: "geoip",
						title: "Location",	
						width: 150		
					},{
						field: "tx_bytes",
						title: "tx",
						sort:  true,					
						templet:'#flowTpl'
          },
					{
						field: "rx_bytes",
						title: "rx",
						sort:  true,				
						templet:'#flowSend'
          },		        												
					{
						field: "risk",
						title: "risk",
						width: 60,				
						templet: function(e) {
							return "Middle" == e.risk ? '<del style="color: #5FB878;">' + e.risk + "</del>": "high" == e.risk ? '<span style="color: #FFB800;">' + 
							       e.risk + "</span>": '<span style="color: #FF5722;">' + e.risk + "</span>"
						}
					}]],
					skin: "line"
			});
					

    });
    
    layui.use("table",function() {
				var table = layui.table;
				var $     = layui.jquery;				
		  
		});
	
    
</script>
</body>
</html>